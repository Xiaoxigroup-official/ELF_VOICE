--- 开始加载模块 ---
[OK] 成功导入 audio_capture (VAD 版本)
成功导入 sherpa-onnx。
成功导入 soundfile。
成功导入 librosa。
STT (Sherpa-ONNX) 配置: Provider='cpu', Threads=1
提示: 默认使用模型目录 'C:\ELF\sherpa_onnx_paraformer\sherpa-onnx-paraformer-zh-2023-09-14'。可用 --model-dir 覆盖。
[OK] 成功导入 stt (Sherpa-ONNX Paraformer 版本)
OK: 导入 'openai' 库。
OK: 导入 'qianfan' 库。
[OK] 成功导入 llm_interaction (v2.2+)
成功导入 sherpa-onnx。
成功导入 sounddevice, numpy (用于音频播放)。
警告: tts_sherpa_onnx.py 可能缺少 Provider/Threads/Silence 默认值，使用内部回退。
[OK] 成功导入 tts_sherpa_onnx
--- 模块加载结束 ---

--- 检查所有依赖 ---
检查 LLM 依赖...
  'openai' 库: 可用
  'qianfan' 库: 可用
--- 所有必要依赖检查通过 (根据所选模式) ---

=============== 并发语音助手配置 (v3.3 - Text I/O) ===============
  平台: Windows (AMD64)
  输入模式: text (文本输入默认语言: zh)
  输出模式: text
  [LLM/Echo]
    模式: echo
  [通用]
    清理临时文件: 不适用
============================================================
2025-05-15 09:41:12.089 [主线程] 准备启动所有工作线程...
2025-05-15 09:41:12.089 [文本输入线程] 启动 (默认语言: zh)。 输入 'exit', 'quit' 或 '退出' 来结束程序。
2025-05-15 09:41:12.090 [主线程] 已启动线程: TextInputThread
2025-05-15 09:41:12.090 [LLM线程] 启动 (模式: echo, 输出模式: text)...
2025-05-15 09:41:12.090 [主线程] 已启动线程: LLMThread

2025-05-15 09:41:12.090 [主线程] 所有选定模式的线程已启动。流水线开始运行...
2025-05-15 09:41:12.090 [主线程] （文本输入模式）请在下方提示符后输入文本并按回车。
2025-05-15 09:41:12.090 [主线程] 按 Ctrl+C 或发送 SIGTERM/SIGBREAK 信号来优雅地停止程序。
2025-05-15 09:41:12.090 [主线程] 在文本输入提示符后输入 'exit', 'quit' 或 '退出' 也可以停止程序。

2025-05-15 09:41:12.141 [你 (zh)]: 2025-05-15 09:41:12.143 [文本输入线程] 收到文本: '访问...', 判定语言: zh

2025-05-15 09:41:12.143 [LLM线程] 从 stt_queue 收到: '访问...', Reported Lang: zh
2025-05-15 09:41:12.143 [LLM线程] 调用 LLM: mode='echo', provider='None', model='默认'

--- LLM 交互 ---
模式: echo
Prompt: '访问...'
响应: Echo: 访问...
-----------------------
2025-05-15 09:41:12.143 [LLM线程] 获取响应成功 (耗时 0.00s): 'Echo: 访问...'

2025-05-15 09:41:12.143 [LLM输出]: 访问

2025-05-15 09:41:12.314 [你 (zh)]: 2025-05-15 09:41:12.314 [文本输入线程] 检测到退出命令。
2025-05-15 09:41:12.314 [文本输入线程] 停止。

2025-05-15 09:41:12.597 [主线程] stop_event 已设置或检测到线程退出，开始关闭流程...
2025-05-15 09:41:12.597 [主线程] 开始清理和关闭...
2025-05-15 09:41:12.597 [主线程] 等待工作线程结束 (总超时: 10s)...
2025-05-15 09:41:12.597 [主线程] 仍在活动的线程: ['LLMThread']
2025-05-15 09:41:12.645 [LLM线程] 收到停止信号且 stt_queue 为空，退出。
2025-05-15 09:41:12.645 [LLM线程] 停止。
2025-05-15 09:41:12.645 [主线程] 所有工作线程均已结束。
2025-05-15 09:41:12.645 [主线程] 跳过临时文件清理 (非语音输入模式或 --no-cleanup)。

2025-05-15 09:41:12.645 [主线程] 程序退出。
